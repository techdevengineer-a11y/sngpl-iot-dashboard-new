import{r as o,a as E,g as _,h as R,j as e,u as I,B,C as T,L as M}from"./index-CuPLTIq6.js";const W=({isOpen:f,onClose:d})=>{const[m,k]=o.useState(""),[c,w]=o.useState({devices:[],alarms:[],readings:[]}),[v,u]=o.useState(!1),[p,h]=o.useState(0),b=E();o.useEffect(()=>{f&&(k(""),w({devices:[],alarms:[],readings:[]}),h(0))},[f]),o.useEffect(()=>{if(m.trim().length>0){const s=setTimeout(()=>{S()},300);return()=>clearTimeout(s)}else w({devices:[],alarms:[],readings:[]})},[m]);const S=async()=>{u(!0);try{const[s,l]=await Promise.all([_(),R({limit:50})]),n=m.toLowerCase(),g=s.filter(x=>x.device_name.toLowerCase().includes(n)||x.client_id.toLowerCase().includes(n)||x.location.toLowerCase().includes(n)).slice(0,5),C=l.filter(x=>x.client_id.toLowerCase().includes(n)||x.parameter.toLowerCase().includes(n)||x.severity.toLowerCase().includes(n)).slice(0,5);w({devices:g,alarms:C,readings:[]}),h(0)}catch(s){console.error("Search error:",s)}finally{u(!1)}},y=()=>[...c.devices.map(s=>({type:"device",data:s})),...c.alarms.map(s=>({type:"alarm",data:s}))],L=s=>{const l=y();s.key==="ArrowDown"?(s.preventDefault(),h(n=>(n+1)%l.length)):s.key==="ArrowUp"?(s.preventDefault(),h(n=>(n-1+l.length)%l.length)):s.key==="Enter"&&l.length>0?(s.preventDefault(),j(l[p])):s.key==="Escape"&&d()},j=s=>{s.type==="device"?b("/devices"):s.type==="alarm"&&b("/alarms"),d()},N=s=>({device:"ðŸ“¡",alarm:"ðŸ””",reading:"ðŸ“Š"})[s]||"ðŸ”",r=c.devices.length+c.alarms.length;return f?e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-start justify-center pt-20",children:e.jsx("div",{className:"w-full max-w-2xl mx-4",children:e.jsxs("div",{className:"bg-gray-900 border-2 border-blue-500 rounded-xl shadow-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 flex items-center space-x-3 border-b border-gray-700",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ”"}),e.jsx("input",{type:"text",value:m,onChange:s=>k(s.target.value),onKeyDown:L,placeholder:"Search devices, alarms, readings...",className:"flex-1 bg-transparent text-white text-lg outline-none",autoFocus:!0}),v&&e.jsx("div",{className:"text-gray-400 text-sm animate-pulse",children:"Searching..."}),e.jsx("button",{onClick:d,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("span",{className:"text-xl",children:"âœ•"})})]}),m.trim().length>0&&e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:r===0&&!v?e.jsxs("div",{className:"p-12 text-center text-gray-400",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),e.jsxs("p",{className:"text-lg",children:['No results found for "',m,'"']}),e.jsx("p",{className:"text-sm mt-2",children:"Try searching for device names, IDs, or alarm types"})]}):e.jsxs("div",{children:[c.devices.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"px-4 py-2 bg-gray-800/50 text-gray-400 text-xs font-semibold uppercase",children:["Devices (",c.devices.length,")"]}),c.devices.map((s,l)=>{const g=l===p;return e.jsxs("div",{onClick:()=>j({type:"device"}),className:`p-4 flex items-center space-x-4 cursor-pointer transition-all duration-200 border-l-4 ${g?"bg-blue-600/20 border-blue-500":"bg-transparent border-transparent hover:bg-gray-800/50"}`,children:[e.jsx("span",{className:"text-3xl",children:N("device")}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:s.device_name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[s.client_id," â€¢ ",s.location]})]}),e.jsx("div",{className:`w-2 h-2 rounded-full ${s.is_active?"bg-green-500 animate-pulse":"bg-red-500"}`})]},`device-${s.id}`)})]}),c.alarms.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"px-4 py-2 bg-gray-800/50 text-gray-400 text-xs font-semibold uppercase",children:["Alarms (",c.alarms.length,")"]}),c.alarms.map((s,l)=>{const g=c.devices.length+l===p;return e.jsxs("div",{onClick:()=>j({type:"alarm"}),className:`p-4 flex items-center space-x-4 cursor-pointer transition-all duration-200 border-l-4 ${g?"bg-blue-600/20 border-blue-500":"bg-transparent border-transparent hover:bg-gray-800/50"}`,children:[e.jsx("span",{className:"text-3xl",children:s.severity==="critical"?"ðŸš¨":s.severity==="warning"?"âš ï¸":"â„¹ï¸"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-white font-medium capitalize",children:[s.severity," - ",s.parameter]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Device ",s.client_id," â€¢ ",new Date(s.triggered_at).toLocaleString()]})]}),!s.is_acknowledged&&e.jsx("span",{className:"px-2 py-1 bg-red-600/20 text-red-400 text-xs rounded",children:"Unread"})]},`alarm-${s.id}`)})]})]})}),m.trim().length===0&&e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ”"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Search across your entire IoT platform"}),e.jsxs("div",{className:"flex items-center justify-center space-x-6 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded border border-gray-700",children:"â†‘â†“"}),e.jsx("span",{children:"Navigate"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded border border-gray-700",children:"Enter"}),e.jsx("span",{children:"Select"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded border border-gray-700",children:"Esc"}),e.jsx("span",{children:"Close"})]})]})]}),r>0&&e.jsxs("div",{className:"px-4 py-3 border-t border-gray-700 flex items-center justify-between text-xs text-gray-400",children:[e.jsxs("div",{children:["Found ",r," result",r!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded border border-gray-700",children:"â†‘â†“"}),e.jsx("span",{children:"Navigate"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded border border-gray-700",children:"Enter"}),e.jsx("span",{children:"Select"})]})]})]})]})})}):null},H=({children:f})=>{var x;const{user:d,logout:m}=I(),{theme:k,toggleTheme:c,isDark:w}=B(),v=T(),u=E(),[p,h]=o.useState(!1),[b,S]=o.useState([]),[y,L]=o.useState(0),[j,N]=o.useState(!1),[r,s]=o.useState(!1);o.useEffect(()=>{const t=i=>{(i.ctrlKey||i.metaKey)&&i.key==="k"&&(i.preventDefault(),N(!0))};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]);const l=[{title:"Main",items:[{path:"/dashboard",label:"Dashboard",icon:"ðŸ“Š",badge:null}]},{title:"Current",items:[{path:"/sections",label:"Sections",icon:"ðŸ¢",badge:null}]},{title:"Monitoring",items:[{path:"/alarms",label:"Alerts",icon:"ðŸ””",badge:y},{path:"/advanced-reports",label:"Advanced Reports",icon:"ðŸ“ˆ",badge:null}]},{title:"Management",items:[{path:"/device-management",label:"Manage",icon:"âš™ï¸",badge:null}]},{title:"Observation",items:[{path:"/under-observation",label:"Under Observation",icon:"ðŸ‘ï¸",badge:null}]},{title:"Utilities",items:[{path:"/odorant-drum",label:"Odorant Drum",icon:"ðŸ›¢ï¸",badge:null}]},{title:"View",items:[{path:"/map",label:"Map",icon:"ðŸ—ºï¸",badge:null}]},{title:"Personal",items:[{path:"/settings",label:"Settings",icon:"âš™ï¸",badge:null}]}];o.useEffect(()=>{n();const t=setInterval(n,1e4);return()=>clearInterval(t)},[]);const n=async()=>{try{const i=(await R({limit:10})).slice(0,5).map(a=>({id:a.id,title:`${a.severity.toUpperCase()}: ${a.parameter}`,message:`Device ${a.client_id} - ${a.value}`,timestamp:a.triggered_at,severity:a.severity,isRead:a.is_acknowledged}));S(i),L(i.filter(a=>!a.isRead).length)}catch(t){console.error("Error fetching notifications:",t)}},g=t=>{const i=new Date,a=new Date(t),$=i-a,D=Math.floor($/6e4),A=Math.floor($/36e5);return D<1?"Just now":D<60?`${D}m ago`:A<24?`${A}h ago`:new Date(t).toLocaleDateString()},C=()=>{m(),u("/login")};return e.jsxs("div",{className:"min-h-screen flex relative",children:[e.jsx("div",{className:"logo-watermark",children:e.jsxs("svg",{viewBox:"0 0 200 200",fill:"currentColor",className:"w-full h-full text-blue-600 animate-spin-slow",children:[e.jsx("circle",{cx:"100",cy:"100",r:"80",opacity:"0.1"}),e.jsx("path",{d:"M100 40 L140 80 L100 120 L60 80 Z",opacity:"0.1"}),e.jsx("text",{x:"100",y:"110",fontSize:"40",textAnchor:"middle",fontWeight:"bold",opacity:"0.15",children:"SMS"})]})}),e.jsx("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[...Array(20)].map((t,i)=>e.jsx("div",{className:"particle absolute w-2 h-2 bg-blue-400/20 rounded-full",style:{left:`${Math.random()*100}%`,animationName:"particle-float",animationDelay:`${Math.random()*5}s`,animationDuration:`${10+Math.random()*10}s`,animationTimingFunction:"linear",animationIterationCount:"infinite"}},i))}),e.jsx("div",{className:"fixed top-20 right-20 w-96 h-96 bg-blue-400/5 rounded-full blur-3xl animate-pulse-slow pointer-events-none"}),e.jsx("div",{className:"fixed bottom-20 left-20 w-96 h-96 bg-indigo-400/5 rounded-full blur-3xl animate-pulse-slow pointer-events-none",style:{animationDelay:"2s"}}),e.jsx("div",{className:"fixed top-1/2 left-1/3 w-64 h-64 bg-violet-400/5 rounded-full blur-3xl animate-float pointer-events-none",style:{animationDelay:"1s"}}),e.jsx("div",{className:"fixed top-1/3 right-1/4 w-80 h-80 bg-purple-400/5 rounded-full blur-3xl animate-float pointer-events-none",style:{animationDelay:"3s"}}),e.jsx("div",{className:"fixed top-1/4 left-1/2 w-48 h-48 bg-cyan-400/5 rounded-full blur-3xl animate-pulse-slow pointer-events-none",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"fixed bottom-1/3 right-1/3 w-56 h-56 bg-pink-400/5 rounded-full blur-3xl animate-float pointer-events-none",style:{animationDelay:"2.5s"}}),e.jsxs("aside",{className:`enterprise-sidebar flex flex-col transition-all duration-300 ${r?"w-16":"w-64"}`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[r?e.jsx(M,{to:"/dashboard",className:"flex items-center justify-center mx-auto",children:e.jsx("img",{src:"/assets/sngpl-logo.png",alt:"SNGPL Logo",className:"h-7 w-auto",onError:t=>{t.target.style.display="none"}})}):e.jsxs(M,{to:"/dashboard",className:"flex items-center space-x-3",children:[e.jsx("img",{src:"/assets/sngpl-logo.png",alt:"SNGPL Logo",className:"h-8 w-auto",onError:t=>{t.target.style.display="none"}}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"SMS Monitoring"})]}),!r&&e.jsx("button",{onClick:()=>s(!r),className:"p-1.5 hover:bg-gray-100 rounded-md transition-colors text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"})})})]}),!r&&e.jsx("div",{className:"p-3 border-b border-gray-200",children:e.jsxs("button",{onClick:()=>N(!0),className:"w-full px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors flex items-center space-x-2 text-gray-600 border border-gray-200",title:"Search (Ctrl+K)",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("span",{className:"text-sm flex-1 text-left",children:"Search..."}),e.jsx("kbd",{className:"px-2 py-0.5 bg-white border border-gray-300 rounded text-xs text-gray-500",children:"âŒ˜K"})]})}),e.jsx("nav",{className:"flex-1 p-3 overflow-y-auto",children:e.jsx("div",{className:"space-y-4",children:l.map((t,i)=>e.jsxs("div",{children:[!r&&e.jsx("div",{className:"px-3 mb-2",children:e.jsx("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider",children:t.title})}),e.jsx("div",{className:"space-y-0.5",children:t.items.map(a=>e.jsxs(M,{to:a.path,className:`flex items-center justify-between px-3 py-2.5 rounded-lg transition-all duration-200 ${v.pathname===a.path?"bg-blue-50 text-blue-600 font-medium border-l-4 border-blue-600 -ml-3 pl-6":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,title:r?a.label:"",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:r?"text-xl mx-auto":"text-base",children:a.icon}),!r&&e.jsx("span",{className:"text-sm",children:a.label})]}),!r&&a.badge!==null&&a.badge>0&&e.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full font-medium",children:a.badge})]},a.path))})]},i))})}),e.jsxs("div",{className:"p-3 border-t border-gray-200 space-y-2",children:[!r&&e.jsxs("button",{onClick:()=>h(!p),className:"relative w-full px-3 py-2 hover:bg-gray-50 rounded-lg transition-colors flex items-center space-x-2 text-gray-700",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),e.jsx("span",{className:"text-sm flex-1 text-left",children:"Notifications"}),y>0&&e.jsx("span",{className:"px-2 py-0.5 bg-red-500 text-white text-xs rounded-full font-medium",children:y})]}),!r&&e.jsxs("div",{className:"px-3 py-2 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:d==null?void 0:d.username}),e.jsx("div",{className:"text-xs text-gray-600 capitalize",children:(d==null?void 0:d.role)||"Administrator"})]}),e.jsxs("button",{onClick:C,className:"w-full px-3 py-2 bg-red-50 hover:bg-red-100 text-red-600 rounded-lg transition-colors font-medium flex items-center justify-center space-x-2 border border-red-200",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),!r&&e.jsx("span",{className:"text-sm",children:"Sign Out"})]})]})]}),e.jsxs("div",{className:`flex-1 flex flex-col min-h-screen transition-all duration-300 ${r?"ml-16":"ml-64"}`,children:[e.jsxs("header",{className:"enterprise-header h-14 flex items-center justify-between px-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[r&&e.jsx("button",{onClick:()=>s(!1),className:"p-1.5 hover:bg-gray-100 rounded-md transition-colors text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:((x=l.flatMap(t=>t.items).find(t=>t.path===v.pathname))==null?void 0:x.label)||"Dashboard"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"text-xs text-gray-600",children:new Date().toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})})]}),e.jsx("main",{className:"flex-1 p-8 overflow-y-auto",children:f})]}),p&&e.jsxs("div",{className:`fixed ${r?"left-20":"left-68"} top-20 w-96 bg-white border border-gray-200 rounded-lg shadow-xl z-50 max-h-[600px] overflow-hidden`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsx("h3",{className:"text-gray-900 font-semibold text-sm",children:"Notifications"}),e.jsx("button",{onClick:()=>{h(!1),u("/alarms")},className:"text-blue-600 hover:text-blue-700 text-xs font-medium",children:"View All"})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:b.length===0?e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),e.jsx("p",{className:"text-sm",children:"No notifications"})]}):b.map(t=>e.jsx("div",{onClick:()=>{h(!1),u("/alarms")},className:`p-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors ${t.isRead?"":"bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`p-1.5 rounded-full ${t.severity==="critical"?"bg-red-100 text-red-600":t.severity==="warning"?"bg-yellow-100 text-yellow-600":"bg-blue-100 text-blue-600"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("p",{className:"text-gray-900 font-medium text-xs truncate",children:t.title}),!t.isRead&&e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-600 flex-shrink-0"})]}),e.jsx("p",{className:"text-gray-400 text-xs mt-1 truncate",children:t.message}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:g(t.timestamp)})]})]})},t.id))}),b.length>0&&e.jsx("div",{className:"p-3 border-t border-gray-700 text-center",children:e.jsx("button",{onClick:()=>{h(!1),u("/notifications")},className:"text-blue-400 hover:text-blue-300 text-sm font-medium",children:"View All Notifications â†’"})})]}),e.jsx(W,{isOpen:j,onClose:()=>N(!1)})]})};export{H as L};
